# Claude Code æ•°æ®ç»“æ„è¯¦è§£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Claude Code çš„æ•°æ®å­˜å‚¨ç»“æ„ã€ç´¢å¼•è§„åˆ™å’Œæ–‡ä»¶ç»„ç»‡æ–¹å¼ã€‚

---

## ç›®å½•

- [æ ¸å¿ƒæ¦‚å¿µå…³ç³»](#æ ¸å¿ƒæ¦‚å¿µå…³ç³»)
- [æ•°æ®ç›®å½•ç»“æ„](#æ•°æ®ç›®å½•ç»“æ„)
- [history.jsonl ç´¢å¼•è§„åˆ™](#historyjsonl-ç´¢å¼•è§„åˆ™)
- [å¯¹è¯æ–‡ä»¶ç»“æ„](#å¯¹è¯æ–‡ä»¶ç»“æ„)
- [æ–‡ä»¶è·¯å¾„ç¼–ç è§„åˆ™](#æ–‡ä»¶è·¯å¾„ç¼–ç è§„åˆ™)
- [å…³é”®è¦ç‚¹æ€»ç»“](#å…³é”®è¦ç‚¹æ€»ç»“)

---

## æ ¸å¿ƒæ¦‚å¿µå…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Claude æ•°æ®ç»“æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   Project (é¡¹ç›®è·¯å¾„)                                         â”‚
â”‚      â”‚                                                      â”‚
â”‚      â”œâ”€â”€â”€ SessionID (UUID, æ¯ä¸ªå¯¹è¯ä¼šè¯çš„å”¯ä¸€æ ‡è¯†)           â”‚
â”‚      â”‚      â”‚                                               â”‚
â”‚      â”‚      â”œâ”€â”€â”€ å¯¹è¯æ–‡ä»¶ (.jsonl)   â† å­˜å‚¨å®é™…å¯¹è¯å†…å®¹     â”‚
â”‚      â”‚      â”œâ”€â”€â”€ Debugæ—¥å¿— (.txt)    â† å­˜å‚¨è°ƒè¯•æ—¥å¿—         â”‚
â”‚      â”‚      â”œâ”€â”€â”€ Sessionç¯å¢ƒ (/)     â† å­˜å‚¨ä¼šè¯ç¯å¢ƒå˜é‡     â”‚
â”‚      â”‚      â”œâ”€â”€â”€ æ–‡ä»¶å†å² (/)        â† å­˜å‚¨æ–‡ä»¶æ“ä½œå†å²     â”‚
â”‚      â”‚      â””â”€â”€â”€ Todos (.json)       â† å­˜å‚¨ä»»åŠ¡åˆ—è¡¨         â”‚
â”‚      â”‚                                                      â”‚
â”‚      â””â”€â”€â”€ history.jsonl (å…¨å±€ç´¢å¼•) â† è®°å½•æ‰€æœ‰ä¼šè¯çš„ç´¢å¼•     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| **Project** | è·¯å¾„ | Claude Code å·¥ä½œç›®å½• | `/Users/user_name/project_name` |
| **SessionID** | UUID | æ¯ä¸ªå¯¹è¯ä¼šè¯çš„å”¯ä¸€æ ‡è¯† | `9ad2097a-f51a-4c95-84a6-371e77965720` |
| **customTitle** | å­—ç¬¦ä¸² | ç”¨æˆ·é€šè¿‡ `/rename` è®¾ç½®çš„ä¼šè¯åç§° | `Claudeä¼šè¯ç®¡ç†å¼€å‘å’Œgitç®¡ç†` |
| **slug** | å­—ç¬¦ä¸² | è‡ªåŠ¨ç”Ÿæˆçš„ URL å‹å¥½åç§° | `optimized-munching-seal` |
| **display** | å­—ç¬¦ä¸² | ç”¨æˆ·æ¯æ¬¡è¾“å…¥çš„å³æ—¶æ¶ˆæ¯å†…å®¹ | æ¯æ¬¡å¯¹è¯éƒ½ä¼šæ–°å¢ä¸€æ¡è®°å½• |

---

## æ•°æ®ç›®å½•ç»“æ„

```
~/.claude/
â”œâ”€â”€ history.jsonl           # ğŸ“‹ å…¨å±€ç´¢å¼•æ–‡ä»¶ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ settings.json           # âš™ï¸ Claude é…ç½®
â”œâ”€â”€ stats-cache.json        # ğŸ“Š ç»Ÿè®¡ç¼“å­˜
â”‚
â”œâ”€â”€ projects/               # ğŸ’¬ å¯¹è¯æ•°æ®ç›®å½•
â”‚   â””â”€â”€ -project_name/
â”‚       â”œâ”€â”€ 9ad2097a-f51a-4c95-84a6-371e77965720.jsonl
â”‚       â”œâ”€â”€ cabd4bba-ea6b-4667-a2f0-b04060645410.jsonl
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ debug/                  # ğŸ› è°ƒè¯•æ—¥å¿—
â”‚   â”œâ”€â”€ 9ad2097a-f51a-4c95-84a6-371e77965720.txt
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ session-env/            # ğŸ“¦ ä¼šè¯ç¯å¢ƒå˜é‡
â”‚   â”œâ”€â”€ 9ad2097a-f51a-4c95-84a6-371e77965720/
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ file-history/           # ğŸ“œ æ–‡ä»¶æ“ä½œå†å²
â”‚   â”œâ”€â”€ 9ad2097a-f51a-4c95-84a6-371e77965720/
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ todos/                  # ğŸ“ ä»»åŠ¡åˆ—è¡¨
â”‚   â”œâ”€â”€ 9ad2097a-f51a-4c95-84a6-371e77965720-agent-xxx.json
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ agents/                 # ğŸ¤– Agent é…ç½®ï¼ˆå¯¹è¯æ— å…³ï¼Œä¸åˆ é™¤ï¼‰
â”œâ”€â”€ skills/                 # ğŸ› ï¸ æŠ€èƒ½é…ç½®ï¼ˆå¯¹è¯æ— å…³ï¼Œä¸åˆ é™¤ï¼‰
â”œâ”€â”€ plugins/                # ğŸ”Œ æ’ä»¶ç›®å½•ï¼ˆå¯¹è¯æ— å…³ï¼Œä¸åˆ é™¤ï¼‰
â””â”€â”€ plans/                  # ğŸ“‹ è®¡åˆ’æ–‡ä»¶ï¼ˆå¯¹è¯æ— å…³ï¼Œä¸åˆ é™¤ï¼‰
```

### ç›®å½•è¯´æ˜

| ç›®å½• | è¯´æ˜ | æ˜¯å¦å…³è”ä¼šè¯ |
|------|------|-------------|
| `projects/` | å­˜å‚¨å¯¹è¯å†…å®¹æ–‡ä»¶ | âœ… ä»¥ SessionID å‘½å |
| `debug/` | å­˜å‚¨è°ƒè¯•æ—¥å¿— | âœ… ä»¥ SessionID å‘½å |
| `session-env/` | å­˜å‚¨ä¼šè¯ç¯å¢ƒå˜é‡ | âœ… ä»¥ SessionID å‘½å |
| `file-history/` | å­˜å‚¨æ–‡ä»¶æ“ä½œå†å² | âœ… ä»¥ SessionID å‘½å |
| `todos/` | å­˜å‚¨ Task å·¥å…·åˆ›å»ºçš„ä»»åŠ¡ | âœ… ä»¥ SessionID å¼€å¤´ |
| `agents/` | Agent æ’ä»¶ç¼“å­˜ | âŒ ä¸åˆ é™¤ |
| `skills/` | ç”¨æˆ·è‡ªå®šä¹‰æŠ€èƒ½ | âŒ ä¸åˆ é™¤ |
| `plugins/` | æ’ä»¶å¸‚åœºç¼“å­˜ | âŒ ä¸åˆ é™¤ |
| `plans/` | è®¡åˆ’æ–‡ä»¶ | âŒ ä¸åˆ é™¤ |

---

## history.jsonl ç´¢å¼•è§„åˆ™

### è®°å½•æ ¼å¼

```json
{
  "sessionId": "9ad2097a-f51a-4c95-84a6-371e77965720",
  "project": "/Users/user_name/project_name",
  "display": "ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯å†…å®¹",
  "timestamp": 1769851760301,
  "pastedContents": {}
}
```

### é‡è¦ç‰¹æ€§

1. **æ¯æ¡è®°å½• = ç”¨æˆ·çš„ä¸€æ¬¡è¾“å…¥**
   - æ¯æ¬¡ç”¨æˆ·è¾“å…¥éƒ½ä¼šæ–°å¢ä¸€æ¡è®°å½•
   - åŒä¸€ä¸ª `sessionId` ä¼šæœ‰å¤šæ¡è®°å½•
   - è®°å½•æŒ‰æ—¶é—´é¡ºåºè¿½åŠ 

2. **ç´¢å¼•æ•°é‡ â‰  ä¼šè¯æ•°é‡**
   - ä¾‹å¦‚ï¼š68 æ¡å†å²è®°å½• â†’ åªæœ‰ 8 ä¸ªç‹¬ç«‹ä¼šè¯
   - éœ€è¦æŒ‰ `sessionId` å»é‡

3. **å»é‡è§„åˆ™**
   - æŒ‰ `sessionId` å»é‡
   - å–æ—¶é—´æˆ³æœ€æ–°çš„ä¸€æ¡è®°å½•

### å®é™…æ•°æ®ç¤ºä¾‹

```
sessionId                           å‡ºç°æ¬¡æ•°
----------------------------------- ---------
9ad2097a-f51a-4c95-84a6-371e77965720  44       â† å½“å‰æ´»è·ƒä¼šè¯
789dbf95-049f-429e-8360-0296225c3244   8
9e469d87-0331-47ed-aa2f-ab5f0f7545fe   4
```

---

## å¯¹è¯æ–‡ä»¶ç»“æ„

### æ–‡ä»¶è·¯å¾„

```
~/.claude/projects/<encoded_project>/<sessionId>.jsonl
```

### æ–‡ä»¶å†…éƒ¨æ ¼å¼

å¯¹è¯æ–‡ä»¶æ˜¯ JSON Lines æ ¼å¼ï¼Œæ¯è¡Œä¸€æ¡æ¶ˆæ¯ï¼š

```json
{"type": "user", "userType": "external", "message": {"role": "user", "content": "ç¬¬ä¸€æ¡æ¶ˆæ¯"}, ...}
{"type": "assistant", "userType": "assistant", "message": {"role": "assistant", "content": [...]}, ...}
{"type": "custom-title", "customTitle": "è‡ªå®šä¹‰SessionName", ...}
{"type": "tool", ...}
```

### æ¶ˆæ¯ç±»å‹

| type | userType | è¯´æ˜ |
|------|----------|------|
| `user` | `external` | ç”¨æˆ·æ¶ˆæ¯ |
| `assistant` | `assistant` | Claude å›å¤ |
| `tool` | - | å·¥å…·è°ƒç”¨ç»“æœ |
| `custom-title` | - | ä¼šè¯åç§°ï¼ˆ/rename è®¾ç½®ï¼‰ |
| `file-history-snapshot` | - | æ–‡ä»¶å†å²å¿«ç…§ |

### ä¼šè¯åç§°æ¥æºé¡ºåº

1. **customTitle** - ç”¨æˆ·é€šè¿‡ `/rename` å‘½ä»¤è®¾ç½®çš„åç§°
2. **ç¬¬ä¸€æ¡ç”¨æˆ·æ¶ˆæ¯** - å¯¹è¯æ–‡ä»¶ä¸­ type="user" çš„ç¬¬ä¸€æ¡æ¶ˆæ¯å†…å®¹
3. **display** - history.jsonl ä¸­è¯¥ sessionId çš„æœ€æ–° display å€¼

---

## æ–‡ä»¶è·¯å¾„ç¼–ç è§„åˆ™

### Project è·¯å¾„ç¼–ç 

```
åŸå§‹è·¯å¾„: /Users/user_name/project_name
ç¼–ç è§„åˆ™: å°† / æ›¿æ¢ä¸º -
ç¼–ç ç»“æœ: -project_name
```

**âš ï¸ æ³¨æ„ï¼š**
- ä¸æ˜¯ URL ç¼–ç ï¼
- åªæ˜¯ç®€å•çš„å­—ç¬¦æ›¿æ¢ï¼š`/` â†’ `-`

### å®Œæ•´è·¯å¾„ç¤ºä¾‹

```python
# ç»™å®š
project = "/Users/user_name/project_name"
session_id = "9ad2097a-f51a-4c95-84a6-371e77965720"

# ç¼–ç  project
encoded_project = project.replace('/', '-')
# = "-project_name"

# å¯¹è¯æ–‡ä»¶è·¯å¾„
conversation_file = f"~/.claude/projects/{encoded_project}/{session_id}.jsonl"
# = "~/.claude/projects/-project_name/9ad2097a-f51a-4c95-84a6-371e77965720.jsonl"
```

---

## å…³é”®è¦ç‚¹æ€»ç»“

### SessionID ä¸ä¼šè¯çš„å…³ç³»

| æ¦‚å¿µ | è¯´æ˜ |
|------|------|
| **SessionID å”¯ä¸€æ€§** | ä¸€ä¸ª SessionID = ä¸€ä¸ªå¯¹è¯ä¼šè¯ = ä¸€ä¸ªå¯¹è¯æ–‡ä»¶ |
| **Project å…³è”** | åŒä¸€ä¸ª Project ä¸‹å¯ä»¥æœ‰å¤šä¸ª SessionID |
| **è·¨ Project** | åŒä¸€ä¸ª SessionID ä¸ä¼šå‡ºç°åœ¨å¤šä¸ª Project ä¸­ |

### æ•°æ®å®Œæ•´æ€§åˆ¤æ–­

| æ–‡ä»¶ç±»å‹ | åˆ¤æ–­ä¾æ® |
|---------|---------|
| å¯¹è¯æ–‡ä»¶ | å­˜åœ¨äº `projects/<encoded_project>/<sessionId>.jsonl` |
| Debug æ—¥å¿— | å­˜åœ¨äº `debug/<sessionId>.txt` |
| Session ç¯å¢ƒ | å­˜åœ¨äº `session-env/<sessionId>/` |
| æœ‰æ•ˆä¼šè¯ | åœ¨ `history.jsonl` ä¸­æœ‰å¯¹åº” `sessionId` è®°å½• |

### æ¸…ç†è§„åˆ™

**å®‰å…¨æ¸…ç†æ¡ä»¶**ï¼šæ–‡ä»¶å­˜åœ¨ï¼Œä½†å…¶ `sessionId` ä¸åœ¨ `history.jsonl` ä¸­

âš ï¸ **é£é™©æç¤º**ï¼š
- å¦‚æœæ‰‹åŠ¨åˆ é™¤äº† `history.jsonl` ä¸­çš„è®°å½•
- ç„¶åè¿è¡Œ"æ¸…ç†æ— ç´¢å¼•æ•°æ®"
- å¯èƒ½ä¼šåˆ é™¤ä»åœ¨ä½¿ç”¨çš„ä¼šè¯æ–‡ä»¶

---

## é™„å½•ï¼šå®Œæ•´æ•°æ®æµ

```
ç”¨æˆ·å¯åŠ¨ Claude Code
    â†“
åˆ›å»ºæ–°ä¼šè¯ â†’ ç”Ÿæˆ SessionID (UUID)
    â†“
è®¾ç½®å·¥ä½œç›®å½• â†’ è®°å½• Project è·¯å¾„
    â†“
ç”¨æˆ·è¾“å…¥æ¶ˆæ¯ â†’ å†™å…¥å¯¹è¯æ–‡ä»¶
                â†’ è¿½åŠ  history.jsonl ç´¢å¼•
    â†“
ç”¨æˆ·æ‰§è¡Œ /rename â†’ å†™å…¥ customTitle åˆ°å¯¹è¯æ–‡ä»¶
    â†“
è°ƒç”¨å·¥å…· â†’ å†™å…¥å·¥å…·ç»“æœåˆ°å¯¹è¯æ–‡ä»¶
            â†’ å¯èƒ½ç”Ÿæˆ todos æ–‡ä»¶
    â†“
ä¼šè¯ç»“æŸ â†’ æ–‡ä»¶å…³é—­
```
